<!doctype html>

<!-- 
    idea by ScamperNZ
    programmed by broomholder
 -->
<html>

<head>
    <link rel="stylesheet" type="text/css" media="all" href="css/reset.css" /> <!-- reset css -->
    <style>
        body {
            background-color: ivory;
        }

        img {
            position: absolute;
            top: 350px;
            left: 100px;
        }

        #img1 {
            --i1: 0deg;
            transform: rotate(var(--i1));
        }

        #img2 {
            --i2: 0deg;
            transform: rotate(var(--i2));
        }

        #img3 {
            --i3: 0deg;
            transform: rotate(var(--i3));
        }

        #img4 {
            --i4: 0deg;
            transform: rotate(var(--i4));
        }
    </style>
</head>

<body>
    <h1>
        HURRICANE ScamperNZ
    </h1>
    <h2>
        programmer broomholder
    </h2>



    <button id="playbackwards">Play Backwards</button>
    <button id="pause">Pause</button>
    <button id="playforwards">Play Forwards</button>
    Degrees to rotate: <input type="number" id="increment" min="1" max="359" step="1" placeholder="1">
    Delay (in milliseconds 1-1000): <input type="number" id="delay" min="1" max="10000" step="1" placeholder="200">
    <input type="checkbox" id="coloured">coloured
    <form action="">
        <fieldset>
            <input type="range" name="image1" id="i1r" min="0" max="359">
            <input type="number" name="image1" id="i1n" min="0" max="359">
        </fieldset>
        <fieldset>
            <input type="range" name="image2" id="i2r" min="0" max="359">
            <input type="number" name="image2" id="i2n" min="0" max="359">
        </fieldset>
        <fieldset>
            <input type="range" name="image3" id="i3r" min="0" max="359">
            <input type="number" name="image3" id="i3n" min="0" max="359">
        </fieldset>
        <fieldset>
            <input type="range" name="image4" id="i4r" min="0" max="359">
            <input type="number" name="image4" id="i4n" min="0" max="359">
        </fieldset>
    </form>



    <script>
        const CLU1B = 'https://cdn.discordapp.com/attachments/1026379861549400155/1026381086147747870/Clue1.png';
        const CLU2B = 'https://cdn.discordapp.com/attachments/1026379861549400155/1026381087041126480/Clue2.png';
        const CLU3B = 'https://cdn.discordapp.com/attachments/1026379861549400155/1026381087833849866/Clue3.png';
        const CLU4B = 'https://cdn.discordapp.com/attachments/1026379861549400155/1026381085745102898/Clue4.png';
        const CLU1C = 'https://cdn.discordapp.com/attachments/1026379861549400155/1026381086630105100/Clue1coloured.png';
        const CLU2C = 'https://cdn.discordapp.com/attachments/1026379861549400155/1026381087456378940/Clue2coloured.png';
        const CLU3C = 'https://cdn.discordapp.com/attachments/1026379861549400155/1026381089834549329/Clue3coloured.png';

        const image1 = document.createElement("img");
        const image2 = document.createElement("img");
        const image3 = document.createElement("img");
        const image4 = document.createElement("img");

        image1.src = CLU1B;
        image2.src = CLU2B;
        image3.src = CLU3B;
        image4.src = CLU4B;

        image1.id = "img1";
        image2.id = "img2";
        image3.id = "img3";
        image4.id = "img4";

        document.body.appendChild(image1);
        document.body.appendChild(image2);
        document.body.appendChild(image3);
        document.body.appendChild(image4);

        const forwards = document.querySelector("#playforwards");
        const backwards = document.querySelector("#playbackwards");
        const delay = document.querySelector("#delay");
        const pause = document.querySelector("#pause");
        const coloured = document.querySelector("#coloured");

        const i1r = document.querySelector('#i1r');
        const i1n = document.querySelector('#i1n');
        const i2r = document.querySelector('#i2r');
        const i2n = document.querySelector('#i2n');
        const i3r = document.querySelector('#i3r');
        const i3n = document.querySelector('#i3n');
        const i4r = document.querySelector('#i4r');
        const i4n = document.querySelector('#i4n');

        const rotatePicture = (e) => {

            //what triggered
            console.log(e.target);
            console.log(e.target.name);
            const img = document.querySelector('#img' + e.target.id[1])
            const range = document.querySelector('#i' + e.target.id[1] + 'r')
            const number = document.querySelector('#i' + e.target.id[1] + 'n')

            //get the position
            const css_variable = '--' + e.target.id.slice(0, 2);

            //move it
            const new_angle = e.target.value + 'deg';

            img.style.setProperty(css_variable, new_angle)
            range.value = e.target.value
            number.value = e.target.value
        }

        i1r.addEventListener('change', (e) => rotatePicture(e))
        i1n.addEventListener('change', (e) => rotatePicture(e))
        i2r.addEventListener('change', (e) => rotatePicture(e))
        i2n.addEventListener('change', (e) => rotatePicture(e))
        i3r.addEventListener('change', (e) => rotatePicture(e))
        i3n.addEventListener('change', (e) => rotatePicture(e))
        i4r.addEventListener('change', (e) => rotatePicture(e))
        i4n.addEventListener('change', (e) => rotatePicture(e))

        const play = () => {
            let angle1 = getComputedStyle(image1).getPropertyValue("--i1");
            let angle2 = getComputedStyle(image2).getPropertyValue("--i2");
            let angle3 = getComputedStyle(image3).getPropertyValue("--i3");
            const increment = Number(document.querySelector("#increment").value) || 1;
            let next1 = Number(angle1.match(/[0-9]*/)[0]) + increment;
            let next2 = Number(angle2.match(/[0-9]*/)[0]);
            let next3 = Number(angle3.match(/[0-9]*/)[0]);
            if (next1 >= 360) {
                next1 %= 360
                next2 += increment
                if (next2 >= 360) {
                    next2 %= 360
                    next3 += increment
                    if (next3 >= 360) {
                        next3 %= 360
                    }
                }
            }

            next1 = "" + next1 + "deg";
            next2 = "" + next2 + "deg";
            next3 = "" + next3 + "deg";
            console.log("next1: ", next1);
            console.log("next2: ", next2);
            console.log("next3: ", next3);
            image1.style.setProperty("--i1", next1)
            image2.style.setProperty("--i2", next2)
            image3.style.setProperty("--i3", next3)


        }

        let frame = Number(delay.value) || 200;
        let on = false
        const start = () => {
            if (!on) {
                clockwise = setInterval(play, frame);
                on = true;
            }
        }

        const stop = () => {
            clearInterval(clockwise);
            on = false;
        }

        forwards.addEventListener("click", start);
        pause.addEventListener("click", stop);

        coloured.addEventListener("change", () => {
            console.log(coloured.checked);
            if (coloured.checked) {
                image1.src = CLU1C;
                image2.src = CLU2C;
                image3.src = CLU3C;
            } else {
                image1.src = CLU1B;
                image2.src = CLU2B;
                image3.src = CLU3B;
            }
        })

    </script>
</body>

</html>
